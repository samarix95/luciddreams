(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{871:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(22),o=n(3),i=n.n(o),l=n(842),u=n(243),s=n(248),m=n(244),d=n(722),f=n(844),p=n.n(f),g=n(843),h=n.n(g),y=n(845),E=n.n(y),b=n(70),v=n(89),j=n(242),k=n(140),w=n(251),O=n(250),x=n(490),N=n(200),S=n(207),C=n(541),I=n(402),_=n.n(I),z=n(12);function T(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],a=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(a=(o=i.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(e){r=!0,c=e}finally{try{a||null==i.return||i.return()}finally{if(r)throw c}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function B(e){var t=Object(z.d)(),n=e.i,a=e.j,c=e.cellWidth,o=e.id,i=e.locations,l=e.palette,u=e.lang,d=e.history,f=e.user_id,p=e.posts,g=T(r.a.useState(null),2),h=g[0],y=g[1],E=T(r.a.useState(o||null),2),v=E[0],j=E[1],I=T(r.a.useState(0),2),B=I[0],L=I[1],A=Boolean(h),M=A?"simple-popover":void 0,R=v===o,W=function(e){var t=0;p.map((function(n){return n.tags.map((function(n){return parseInt(n[0])===e?t++:t+=0}))})),L(t)};return r.a.createElement("td",{style:{height:c+"px",minWidth:c+"px",maxWidth:c+"px",padding:0,margin:0,border:"1px rgb(128,128,128,0.8) solid"}},i.length?r.a.createElement("div",{className:t.aboutGridContainer,onClick:function(e){y(e.currentTarget),W(v)},style:"number"==typeof v?{backgroundImage:"url("+i.find((function(e){return e.id===v})).img_url+")",backgroundSize:"contain",backgroundColor:i.find((function(e){return e.id===v})).color,overflow:"hidden"}:{backgroundSize:"contain",backgroundColor:"rgb(192,192,192,0.6)",overflow:"hidden"}}):"",r.a.createElement(N.a,{id:M,open:A,anchorEl:h,anchorOrigin:{vertical:"center",horizontal:"center"},transformOrigin:{vertical:"center",horizontal:"center"}},r.a.createElement(m.a,{container:!0,className:"".concat(t.height12),direction:"column",justify:"center",alignItems:"stretch"},r.a.createElement(m.a,{item:!0,className:"".concat(t.mainGridBodyItem," ").concat(t.height11),style:{padding:"16px"}},i.length?r.a.createElement(m.a,{container:!0,className:"".concat(t.height12),direction:"column",justify:"center",alignItems:"stretch"},r.a.createElement(m.a,{item:!0,className:"".concat(t.height6)},r.a.createElement(m.a,{container:!0,className:"".concat(t.height12),direction:"row",justify:"center",alignItems:"stretch"},r.a.createElement(m.a,{item:!0,xs:10,style:{textAlign:"center",position:"relative"}},r.a.createElement(O.a,{variant:"h6",style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}},"number"==typeof v?"Ru"===u.currLang.current?i.find((function(e){return e.id===v})).name_rus:i.find((function(e){return e.id===v})).name_eng:u.currLang.texts.Nothink)),r.a.createElement(m.a,{item:!0,xs:2},r.a.createElement(w.a,{onClick:function(){d.push({pathname:"/addlocation",defaultData:{id:v,name_rus:i.find((function(e){return e.id===v})).name_rus,name_eng:i.find((function(e){return e.id===v})).name_eng,img_url:i.find((function(e){return e.id===v})).img_url,color:i.find((function(e){return e.id===v})).color,prevUrl:"/dreammap"}})},disabled:"number"!=typeof v},r.a.createElement(_.a,{fontSize:"small"}))))),r.a.createElement(m.a,{item:!0,className:"".concat(t.height6)},r.a.createElement(m.a,{container:!0,direction:"row",justify:"space-around",alignItems:"center"},r.a.createElement(m.a,{item:!0},r.a.createElement(k.a,null,r.a.createElement(S.a,{value:"number"==typeof v?v:"",onChange:function(e){j(e.target.value),W(e.target.value)},MenuProps:{PaperProps:{style:{maxHeight:224,width:"auto"}}}},i.map((function(e,n){return r.a.createElement(x.a,{key:n,value:e.id},r.a.createElement(C.a,{className:t.smallAvatar,src:e.id?e.img_url:"https://static.thenounproject.com/png/1446402-200.png",style:"dark"===l.type?{filter:"invert(1)"}:{}}))}))))),r.a.createElement(m.a,{item:!0},r.a.createElement(s.a,{disabled:0===B,onClick:function(){d.push({pathname:"/dreams",defaultData:{location:i.find((function(e){return e.id===v})),prevUrl:"/dreammap"}})}},u.currLang.texts.dreams,": ",B))))):""),r.a.createElement(m.a,{item:!0,className:"".concat(t.mainGridBodyItem," ").concat(t.height1)},r.a.createElement(m.a,{className:t.menuDivButton,container:!0,direction:"row",justify:"space-around",alignItems:"stretch",style:{padding:"16px"}},r.a.createElement(m.a,{item:!0,xs:6,align:"center"},r.a.createElement(s.a,{className:t.poppupButton,variant:"contained",color:"secondary",onClick:function(){j(o),y(null)}},u.currLang.texts.cancel)),r.a.createElement(m.a,{item:!0,xs:6,align:"center"},r.a.createElement(s.a,{className:t.poppupButton,disabled:R,variant:"contained",color:"primary",onClick:function(){var e={user_id:f,i:n,j:a};e.oldLoc=o,e.newLoc=v,b.a.post("/actions/users/updateusermap",e).then((function(e){})).catch((function(e){console.log(e)})),y(null)}},u.currLang.buttons.Save)))))))}B.propTypes={lang:i.a.object.isRequired,palette:i.a.object.isRequired};var L=Object(c.b)((function(e){return{lang:e.lang,palette:e.themeMode.palette}}),(function(e){return{}}))(B);function A(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},c=Object.keys(e);for(a=0;a<c.length;a++)n=c[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function M(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],a=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(a=(o=i.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(e){r=!0,c=e}finally{try{a||null==i.return||i.return()}finally{if(r)throw c}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var R=(window.innerWidth-32)/20;function W(e){var t=e.lang,n=e.themeMode,a=e.history,c=e.user_id,o=Object(z.d)(),i=Object(v.a)(n),f=M(r.a.useState({}),2),g=f[0],y=f[1],k=M(r.a.useState(null),2),w=k[0],O=k[1],x=M(r.a.useState(null),2),N=x[0],S=x[1],C=r.a.useCallback((function(){b.a.get("/gettags").then((function(e){y([{id:null}].concat(e.data))})).catch((function(e){console.log(e)})),b.a.post("/actions/users/getusermap",{user_id:c}).then((function(e){O(JSON.parse(e.data.result))})).catch((function(e){console.log(e)}))}),[c]),I=r.a.useCallback((function(){b.a.post("/actions/users/getuserposts",{id:c}).then((function(e){S(e.data)})).catch((function(e){}))}),[c]);return r.a.useEffect((function(){C(),I()}),[C,I]),r.a.createElement(j.a,{theme:i},r.a.createElement(u.a,null),r.a.createElement("div",{className:o.root},r.a.createElement(m.a,{container:!0,className:"".concat(o.height12),direction:"column",justify:"center",alignItems:"stretch"},r.a.createElement(m.a,{item:!0,className:"".concat(o.hiddenOverflow," ").concat(o.height2)}),r.a.createElement(m.a,{item:!0,className:"".concat(o.hiddenOverflow," ").concat(o.height9)},r.a.createElement("div",{style:{padding:16},className:"".concat(o.formControl)},r.a.createElement(l.TransformWrapper,{defaultScale:1,options:{minScale:.5,maxScale:2.5},zoomIn:{step:10},zoomOut:{step:10},doubleClick:{disabled:!0}},(function(e){var t,n,o,i=e.zoomIn,u=e.zoomOut,s=e.resetTransform;A(e,["zoomIn","zoomOut","resetTransform"]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(l.TransformComponent,null,r.a.createElement("table",{style:{borderCollapse:"collapse"}},r.a.createElement("tbody",null,null!==w?(t=[],n=0,o=0,Object.keys(w).forEach((function(e){var i=[];Object.keys(w[e]).forEach((function(t){i.push(r.a.createElement(L,{key:"cell"+n+o,i:n,j:o,cellWidth:R,dreamMap:w,id:w[e][t].id,locations:g,history:a,user_id:c,posts:N})),n++})),t.push(r.a.createElement("tr",{key:"row"+o},i)),o++,n=0})),t):r.a.createElement("tr",null,r.a.createElement("td",null))))),r.a.createElement(m.a,{container:!0,className:"tools",direction:"row",justify:"space-evenly",alignItems:"center",style:{marginTop:16}},r.a.createElement(m.a,{item:!0,xs:2,align:"center"}),r.a.createElement(m.a,{item:!0,xs:2,align:"center"},r.a.createElement(d.a,{size:"small",onClick:u},r.a.createElement(h.a,null))),r.a.createElement(m.a,{item:!0,xs:4,align:"center"},r.a.createElement(d.a,{size:"small",onClick:s},r.a.createElement(p.a,null))),r.a.createElement(m.a,{item:!0,xs:2,align:"center"},r.a.createElement(d.a,{size:"small",onClick:i},r.a.createElement(E.a,null))),r.a.createElement(m.a,{item:!0,xs:2,align:"center"})))})))),r.a.createElement(m.a,{item:!0,className:"".concat(o.mainGridBodyItem," ").concat(o.height1)},r.a.createElement(m.a,{container:!0,direction:"row",justify:"space-evenly",alignItems:"center"},r.a.createElement(m.a,{item:!0},r.a.createElement(s.a,{className:o.actionButton,variant:"contained",color:"secondary",onClick:function(){a.push("/luciddreams")}},t.currLang.buttons.close)),r.a.createElement(m.a,{item:!0},r.a.createElement(s.a,{className:o.actionButton,variant:"contained",color:"primary",onClick:function(){a.push("/addlocation")}},t.currLang.buttons.add)))))))}W.propTypes={themeMode:i.a.object.isRequired,lang:i.a.object.isRequired,user_id:i.a.number.isRequired};t.default=Object(c.b)((function(e){return{themeMode:e.themeMode,lang:e.lang,user_id:e.auth.user.id}}),(function(e){return{}}))(W)}}]);
//# sourceMappingURL=13.index-bundle.js.map