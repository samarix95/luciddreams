(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{867:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(22),i=n(3),o=n.n(i),l=n(838),u=n(239),s=n(244),m=n(240),d=n(718),f=n(840),p=n.n(f),g=n(839),h=n.n(g),y=n(841),E=n.n(y),b=n(70),v=n(89),j=n(238),k=n(137),w=n(247),x=n(246),O=n(486),S=n(196),N=n(203),I=n(537),C=n(398),_=n.n(C),z=n(12);function B(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],a=!0,r=!1,c=void 0;try{for(var i,o=e[Symbol.iterator]();!(a=(i=o.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,c=e}finally{try{a||null==o.return||o.return()}finally{if(r)throw c}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function L(e){var t=Object(z.d)(),n=e.i,a=e.j,c=e.cellWidth,i=e.id,o=e.locations,l=e.palette,u=e.lang,d=e.history,f=e.user_id,p=e.posts,g=B(r.a.useState(null),2),h=g[0],y=g[1],E=B(r.a.useState(i||null),2),v=E[0],j=E[1],C=B(r.a.useState(0),2),L=C[0],T=C[1],A=Boolean(h),M=A?"simple-popover":void 0,R=v===i,W=function(e){var t=0;p.map((function(n){return n.tags.map((function(n){return parseInt(n[0])===e?t++:t+=0}))})),T(t)};return r.a.createElement("td",{style:{height:c+"px",minWidth:c+"px",maxWidth:c+"px",padding:0,margin:0,border:"1px rgb(128,128,128,0.8) solid"}},o.length?r.a.createElement("div",{className:t.aboutGridContainer,onClick:function(e){y(e.currentTarget),W(v)},style:"number"==typeof v?{backgroundImage:"url("+o.find((function(e){return e.id===v})).img_url+")",backgroundSize:"contain",backgroundColor:o.find((function(e){return e.id===v})).color,overflow:"hidden"}:{backgroundSize:"contain",backgroundColor:"rgb(192,192,192,0.6)",overflow:"hidden"}}):"",r.a.createElement(S.a,{id:M,open:A,anchorEl:h,anchorOrigin:{vertical:"center",horizontal:"center"},transformOrigin:{vertical:"center",horizontal:"center"}},r.a.createElement(m.a,{container:!0,className:"".concat(t.height12),direction:"column",justify:"center",alignItems:"stretch"},r.a.createElement(m.a,{item:!0,className:"".concat(t.mainGridBodyItem," ").concat(t.height11),style:{padding:"16px"}},o.length?r.a.createElement(m.a,{container:!0,className:"".concat(t.height12),direction:"column",justify:"center",alignItems:"stretch"},r.a.createElement(m.a,{item:!0,className:"".concat(t.height6)},r.a.createElement(m.a,{container:!0,className:"".concat(t.height12),direction:"row",justify:"center",alignItems:"stretch"},r.a.createElement(m.a,{item:!0,xs:10,style:{textAlign:"center",position:"relative"}},r.a.createElement(x.a,{variant:"h6",style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}},"number"==typeof v?"Ru"===u.currLang.current?o.find((function(e){return e.id===v})).name_rus:o.find((function(e){return e.id===v})).name_eng:u.currLang.texts.Nothink)),r.a.createElement(m.a,{item:!0,xs:2},r.a.createElement(w.a,{onClick:function(){d.push({pathname:"/addlocation",defaultData:{id:v,name_rus:o.find((function(e){return e.id===v})).name_rus,name_eng:o.find((function(e){return e.id===v})).name_eng,img_url:o.find((function(e){return e.id===v})).img_url,color:o.find((function(e){return e.id===v})).color,prevUrl:"/dreammap"}})},disabled:"number"!=typeof v},r.a.createElement(_.a,{fontSize:"small"}))))),r.a.createElement(m.a,{item:!0,className:"".concat(t.height6)},r.a.createElement(m.a,{container:!0,direction:"row",justify:"space-around",alignItems:"center"},r.a.createElement(m.a,{item:!0},r.a.createElement(k.a,null,r.a.createElement(N.a,{value:"number"==typeof v?v:"",onChange:function(e){j(e.target.value),W(e.target.value)},MenuProps:{PaperProps:{style:{maxHeight:224,width:"auto"}}}},o.map((function(e,n){return r.a.createElement(O.a,{key:n,value:e.id},r.a.createElement(I.a,{className:t.smallAvatar,src:e.id?e.img_url:"https://static.thenounproject.com/png/1446402-200.png",style:"dark"===l.type?{filter:"invert(1)"}:{}}))}))))),r.a.createElement(m.a,{item:!0},r.a.createElement(s.a,{disabled:0===L,onClick:function(){d.push({pathname:"/dreams",defaultData:{location:o.find((function(e){return e.id===v})),prevUrl:"/dreammap"}})}},u.currLang.texts.dreams,": ",L))))):""),r.a.createElement(m.a,{item:!0,className:"".concat(t.mainGridBodyItem," ").concat(t.height1)},r.a.createElement(m.a,{className:t.menuDivButton,container:!0,direction:"row",justify:"space-around",alignItems:"stretch",style:{padding:"16px"}},r.a.createElement(m.a,{item:!0,xs:6,align:"center"},r.a.createElement(s.a,{className:t.poppupButton,variant:"contained",color:"secondary",onClick:function(){j(i),y(null)}},u.currLang.texts.cancel)),r.a.createElement(m.a,{item:!0,xs:6,align:"center"},r.a.createElement(s.a,{className:t.poppupButton,disabled:R,variant:"contained",color:"primary",onClick:function(){var e={user_id:f,i:n,j:a};e.oldLoc=i,e.newLoc=v,b.a.post("/actions/users/updateusermap",e).then((function(e){})).catch((function(e){console.log(e)})),y(null)}},u.currLang.buttons.Save)))))))}L.propTypes={lang:o.a.object.isRequired,palette:o.a.object.isRequired};var T=Object(c.b)((function(e){return{lang:e.lang,palette:e.themeMode.palette}}),(function(e){return{}}))(L);function A(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},c=Object.keys(e);for(a=0;a<c.length;a++)n=c[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function M(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],a=!0,r=!1,c=void 0;try{for(var i,o=e[Symbol.iterator]();!(a=(i=o.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,c=e}finally{try{a||null==o.return||o.return()}finally{if(r)throw c}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var R=Math.round(window.innerWidth/20*1.5*.6);function W(e){var t=e.lang,n=e.themeMode,a=e.history,c=e.user_id,i=Object(z.d)(),o=Object(v.a)(n),f=M(r.a.useState({}),2),g=f[0],y=f[1],k=M(r.a.useState(null),2),w=k[0],x=k[1],O=M(r.a.useState(null),2),S=O[0],N=O[1],I=r.a.useCallback((function(){b.a.get("/gettags").then((function(e){y([{id:null}].concat(e.data))})).catch((function(e){console.log(e)})),b.a.post("/actions/users/getusermap",{user_id:c}).then((function(e){x(JSON.parse(e.data.result))})).catch((function(e){console.log(e)}))}),[c]),C=r.a.useCallback((function(){b.a.post("/actions/users/getuserposts",{id:c}).then((function(e){N(e.data)})).catch((function(e){}))}),[c]);return r.a.useEffect((function(){I(),C()}),[I,C]),r.a.createElement(j.a,{theme:o},r.a.createElement(u.a,null),r.a.createElement("div",{className:i.root},r.a.createElement(m.a,{container:!0,className:"".concat(i.height12),direction:"column",justify:"center",alignItems:"stretch"},r.a.createElement(m.a,{item:!0,className:"".concat(i.hiddenOverflow," ").concat(i.height11)},r.a.createElement(l.TransformWrapper,{defaultScale:1,options:{minScale:.5,maxScale:2.5},zoomIn:{step:10},zoomOut:{step:10},doubleClick:{disabled:!0}},(function(e){var t,n,i,o=e.zoomIn,u=e.zoomOut,s=e.resetTransform;A(e,["zoomIn","zoomOut","resetTransform"]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(l.TransformComponent,{style:{height:"100%"}},r.a.createElement("table",null,r.a.createElement("tbody",null,null!==w?(t=[],n=0,i=0,Object.keys(w).forEach((function(e){var o=[];Object.keys(w[e]).forEach((function(t){o.push(r.a.createElement(T,{key:"cell"+n+i,i:n,j:i,cellWidth:R,dreamMap:w,id:w[e][t].id,locations:g,history:a,user_id:c,posts:S})),n++})),t.push(r.a.createElement("tr",{key:"row"+i},o)),i++,n=0})),t):r.a.createElement("tr",null,r.a.createElement("td",null))))),r.a.createElement(m.a,{container:!0,className:"tools",direction:"row",justify:"space-evenly",alignItems:"center"},r.a.createElement(m.a,{item:!0,xs:2,align:"center"}),r.a.createElement(m.a,{item:!0,xs:2,align:"center"},r.a.createElement(d.a,{size:"small",onClick:u},r.a.createElement(h.a,null))),r.a.createElement(m.a,{item:!0,xs:4,align:"center"},r.a.createElement(d.a,{size:"small",onClick:s},r.a.createElement(p.a,null))),r.a.createElement(m.a,{item:!0,xs:2,align:"center"},r.a.createElement(d.a,{size:"small",onClick:o},r.a.createElement(E.a,null))),r.a.createElement(m.a,{item:!0,xs:2,align:"center"})))}))),r.a.createElement(m.a,{item:!0,className:"".concat(i.mainGridBodyItem," ").concat(i.height1)},r.a.createElement(m.a,{container:!0,direction:"row",justify:"space-evenly",alignItems:"center"},r.a.createElement(m.a,{item:!0},r.a.createElement(s.a,{className:i.actionButton,variant:"contained",color:"secondary",onClick:function(){a.push("/luciddreams")}},t.currLang.buttons.close)),r.a.createElement(m.a,{item:!0},r.a.createElement(s.a,{className:i.actionButton,variant:"contained",color:"primary",onClick:function(){a.push("/addlocation")}},t.currLang.buttons.add)))))))}W.propTypes={themeMode:o.a.object.isRequired,lang:o.a.object.isRequired,user_id:o.a.number.isRequired};t.default=Object(c.b)((function(e){return{themeMode:e.themeMode,lang:e.lang,user_id:e.auth.user.id}}),(function(e){return{}}))(W)}}]);
//# sourceMappingURL=13.index-bundle.js.map