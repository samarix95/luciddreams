(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{872:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(22),o=n(3),i=n.n(o),l=n(842),u=n(243),s=n(250),m=n(248),d=n(244),f=n(722),p=n(844),g=n.n(p),h=n(843),y=n.n(h),E=n(845),b=n.n(E),v=n(70),j=n(89),k=n(242),w=n(141),x=n(251),O=n(491),N=n(200),S=n(207),C=n(409),I=n(316),_=n.n(I),z=n(12);function B(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],a=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(a=(o=i.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(e){r=!0,c=e}finally{try{a||null==i.return||i.return()}finally{if(r)throw c}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function L(e){var t=Object(z.d)(),n=e.i,a=e.j,c=e.cellWidth,o=e.id,i=e.locations,l=e.palette,u=e.lang,f=e.history,p=e.user_id,g=e.posts,h=B(r.a.useState(null),2),y=h[0],E=h[1],b=B(r.a.useState(o||null),2),j=b[0],k=b[1],I=B(r.a.useState(0),2),L=I[0],M=I[1],T=Boolean(y),A=T?"simple-popover":void 0,W=j===o,P=function(e){var t=0;g.map((function(n){return n.tags.map((function(n){return parseInt(n[0])===e?t++:t+=0}))})),M(t)};return r.a.createElement("td",{style:{height:c+"px",minWidth:c+"px",maxWidth:c+"px",padding:0,margin:0,border:"1px rgb(128,128,128,0.8) solid"}},i.length?r.a.createElement("div",{className:t.aboutGridContainer,onClick:function(e){E(e.currentTarget),P(j)},style:"number"==typeof j?{backgroundImage:"url("+i.find((function(e){return e.id===j})).img_url+")",backgroundSize:"contain",backgroundColor:i.find((function(e){return e.id===j})).color,overflow:"hidden"}:{backgroundSize:"contain",backgroundColor:"rgb(192,192,192,0.6)",overflow:"hidden"}}):"",r.a.createElement(N.a,{id:A,open:T,anchorEl:y,anchorOrigin:{vertical:"center",horizontal:"center"},transformOrigin:{vertical:"center",horizontal:"center"}},r.a.createElement(d.a,{container:!0,className:"".concat(t.height12),direction:"column",justify:"center",alignItems:"stretch"},r.a.createElement(d.a,{item:!0,className:"".concat(t.mainGridBodyItem," ").concat(t.height11),style:{padding:"16px"}},i.length?r.a.createElement(d.a,{container:!0,className:"".concat(t.height12),direction:"column",justify:"center",alignItems:"stretch"},r.a.createElement(d.a,{item:!0,className:"".concat(t.height6)},r.a.createElement(d.a,{container:!0,className:"".concat(t.height12),direction:"row",justify:"center",alignItems:"stretch"},r.a.createElement(d.a,{item:!0,xs:10,style:{textAlign:"center",position:"relative"}},r.a.createElement(s.a,{variant:"h6",style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}},"number"==typeof j?"Ru"===u.currLang.current?i.find((function(e){return e.id===j})).name_rus:i.find((function(e){return e.id===j})).name_eng:u.currLang.texts.Nothink)),r.a.createElement(d.a,{item:!0,xs:2},r.a.createElement(x.a,{onClick:function(){f.push({pathname:"/addlocation",defaultData:{id:j,name_rus:i.find((function(e){return e.id===j})).name_rus,name_eng:i.find((function(e){return e.id===j})).name_eng,img_url:i.find((function(e){return e.id===j})).img_url,color:i.find((function(e){return e.id===j})).color,prevUrl:"/dreammap"}})},disabled:"number"!=typeof j},r.a.createElement(_.a,{fontSize:"small"}))))),r.a.createElement(d.a,{item:!0,className:"".concat(t.height6)},r.a.createElement(d.a,{container:!0,direction:"row",justify:"space-around",alignItems:"center"},r.a.createElement(d.a,{item:!0},r.a.createElement(w.a,null,r.a.createElement(S.a,{value:"number"==typeof j?j:"",onChange:function(e){k(e.target.value),P(e.target.value)},MenuProps:{PaperProps:{style:{maxHeight:224,width:"auto"}}}},i.map((function(e,n){return r.a.createElement(O.a,{key:n,value:e.id},r.a.createElement(C.a,{className:t.smallAvatar,src:e.id?e.img_url:"https://static.thenounproject.com/png/1446402-200.png",style:"dark"===l.type?{filter:"invert(1)"}:{}}))}))))),r.a.createElement(d.a,{item:!0},r.a.createElement(m.a,{disabled:0===L,onClick:function(){f.push({pathname:"/dreams",defaultData:{mode:"fromMap",location:i.find((function(e){return e.id===j})),prevUrl:"/dreammap"}})}},u.currLang.texts.dreams,": ",L))))):""),r.a.createElement(d.a,{item:!0,className:"".concat(t.mainGridBodyItem," ").concat(t.height1)},r.a.createElement(d.a,{className:t.menuDivButton,container:!0,direction:"row",justify:"space-around",alignItems:"stretch",style:{padding:"16px"}},r.a.createElement(d.a,{item:!0,xs:6,align:"center"},r.a.createElement(m.a,{className:t.poppupButton,variant:"contained",color:"secondary",onClick:function(){k(o),E(null)}},u.currLang.texts.cancel)),r.a.createElement(d.a,{item:!0,xs:6,align:"center"},r.a.createElement(m.a,{className:t.poppupButton,disabled:W,variant:"contained",color:"primary",onClick:function(){var e={user_id:p,i:n,j:a};e.oldLoc=o,e.newLoc=j,v.a.post("/actions/users/updateusermap",e).then((function(e){})).catch((function(e){console.log(e)})),E(null)}},u.currLang.buttons.Save)))))))}L.propTypes={lang:i.a.object.isRequired,palette:i.a.object.isRequired};var M=Object(c.b)((function(e){return{lang:e.lang,palette:e.themeMode.palette}}),(function(e){return{}}))(L);function T(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},c=Object.keys(e);for(a=0;a<c.length;a++)n=c[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function A(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],a=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(a=(o=i.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(e){r=!0,c=e}finally{try{a||null==i.return||i.return()}finally{if(r)throw c}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var W=(window.innerWidth-32)/20;function P(e){var t=e.lang,n=e.themeMode,a=e.history,c=e.user_id,o=Object(z.d)(),i=Object(j.a)(n),p=A(r.a.useState({}),2),h=p[0],E=p[1],w=A(r.a.useState(null),2),x=w[0],O=w[1],N=A(r.a.useState(null),2),S=N[0],C=N[1],I=r.a.useCallback((function(){v.a.get("/gettags").then((function(e){E([{id:null}].concat(e.data))})).catch((function(e){console.log(e)})),v.a.post("/actions/users/getusermap",{user_id:c}).then((function(e){O(JSON.parse(e.data.result))})).catch((function(e){console.log(e)}))}),[c]),_=r.a.useCallback((function(){v.a.post("/actions/users/getuserposts",{id:c}).then((function(e){C(e.data)})).catch((function(e){}))}),[c]);return r.a.useEffect((function(){I(),_()}),[I,_]),r.a.createElement(k.a,{theme:i},r.a.createElement(u.a,null),r.a.createElement("div",{className:o.root},r.a.createElement(d.a,{container:!0,className:"".concat(o.height12),direction:"column",justify:"center",alignItems:"stretch"},r.a.createElement(d.a,{item:!0,className:"".concat(o.hiddenOverflow," ").concat(o.height2," ").concat(o.relativePosition),align:"center"},r.a.createElement(s.a,{variant:"h6",component:"div",className:"".concat(o.centerButton)},t.currLang.texts.DreamsMap)),r.a.createElement(d.a,{item:!0,className:"".concat(o.hiddenOverflow," ").concat(o.height9)},r.a.createElement("div",{style:{padding:16},className:"".concat(o.formControl," ").concat(o.fullMinWidthAbs)},r.a.createElement(l.TransformWrapper,{defaultScale:1,options:{minScale:.5,maxScale:2.5},zoomIn:{step:10},zoomOut:{step:10},doubleClick:{disabled:!0}},(function(e){var t,n,o,i=e.zoomIn,u=e.zoomOut,s=e.resetTransform;T(e,["zoomIn","zoomOut","resetTransform"]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(l.TransformComponent,null,r.a.createElement("table",{style:{borderCollapse:"collapse"}},r.a.createElement("tbody",null,null!==x?(t=[],n=0,o=0,Object.keys(x).forEach((function(e){var i=[];Object.keys(x[e]).forEach((function(t){i.push(r.a.createElement(M,{key:"cell"+n+o,i:n,j:o,cellWidth:W,dreamMap:x,id:x[e][t].id,locations:h,history:a,user_id:c,posts:S})),n++})),t.push(r.a.createElement("tr",{key:"row"+o},i)),o++,n=0})),t):r.a.createElement("tr",null,r.a.createElement("td",null))))),r.a.createElement(d.a,{container:!0,className:"tools",direction:"row",justify:"space-evenly",alignItems:"center",style:{marginTop:16}},r.a.createElement(d.a,{item:!0,xs:2,align:"center"}),r.a.createElement(d.a,{item:!0,xs:2,align:"center"},r.a.createElement(f.a,{size:"small",onClick:u},r.a.createElement(y.a,null))),r.a.createElement(d.a,{item:!0,xs:4,align:"center"},r.a.createElement(f.a,{size:"small",onClick:s},r.a.createElement(g.a,null))),r.a.createElement(d.a,{item:!0,xs:2,align:"center"},r.a.createElement(f.a,{size:"small",onClick:i},r.a.createElement(b.a,null))),r.a.createElement(d.a,{item:!0,xs:2,align:"center"})))})))),r.a.createElement(d.a,{item:!0,className:"".concat(o.mainGridBodyItem," ").concat(o.height1)},r.a.createElement(d.a,{container:!0,direction:"row",justify:"space-evenly",alignItems:"center"},r.a.createElement(d.a,{item:!0},r.a.createElement(m.a,{className:o.actionButton,variant:"contained",color:"secondary",onClick:function(){a.push("/luciddreams")}},t.currLang.buttons.close)),r.a.createElement(d.a,{item:!0},r.a.createElement(m.a,{className:o.actionButton,variant:"contained",color:"primary",onClick:function(){a.push("/addlocation")}},t.currLang.buttons.add)))))))}P.propTypes={themeMode:i.a.object.isRequired,lang:i.a.object.isRequired,user_id:i.a.number.isRequired};t.default=Object(c.b)((function(e){return{themeMode:e.themeMode,lang:e.lang,user_id:e.auth.user.id}}),(function(e){return{}}))(P)}}]);
//# sourceMappingURL=14.index-bundle.js.map