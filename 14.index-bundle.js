(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{874:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(22),o=a(3),i=a.n(o),l=a(844),s=a(254),u=a(245),m=a(252),d=a(250),f=a(246),p=a(723),g=a(846),h=a.n(g),E=a(845),y=a.n(E),b=a(847),v=a.n(b),j=a(70),k=a(89),x=a(244),w=a(142),N=a(253),O=a(498),S=a(201),C=a(208),I=a(411),_=a(318),z=a.n(_),L=a(12);function B(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var a=[],n=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(n=(o=i.next()).done)&&(a.push(o.value),!t||a.length!==t);n=!0);}catch(e){r=!0,c=e}finally{try{n||null==i.return||i.return()}finally{if(r)throw c}}return a}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function T(e){var t=Object(L.d)(),a=e.i,n=e.j,c=e.cellWidth,o=e.id,i=e.locations,l=e.palette,s=e.lang,u=e.history,p=e.user_id,g=e.posts,h=B(r.a.useState(null),2),E=h[0],y=h[1],b=B(r.a.useState(o||null),2),v=b[0],k=b[1],x=B(r.a.useState(0),2),_=x[0],T=x[1],A=Boolean(E),M=A?"simple-popover":void 0,P=v===o,W=function(e){var t=0;g.map((function(a){return a.tags.map((function(a){return parseInt(a[0])===e?t++:t+=0}))})),T(t)};return r.a.createElement("td",{style:{height:c+"px",minWidth:c+"px",maxWidth:c+"px",padding:0,margin:0,border:"1px rgb(128,128,128,0.8) solid"}},i.length?r.a.createElement("div",{className:t.aboutGridContainer,onClick:function(e){y(e.currentTarget),W(v)},style:"number"==typeof v?{backgroundImage:"url("+i.find((function(e){return e.id===v})).img_url+")",backgroundSize:"contain",backgroundColor:i.find((function(e){return e.id===v})).color,overflow:"hidden"}:{backgroundSize:"contain",backgroundColor:"rgb(192,192,192,0.6)",overflow:"hidden"}}):"",r.a.createElement(S.a,{id:M,open:A,anchorEl:E,anchorOrigin:{vertical:"center",horizontal:"center"},transformOrigin:{vertical:"center",horizontal:"center"}},r.a.createElement(f.a,{container:!0,className:"".concat(t.height12),direction:"column",justify:"center",alignItems:"stretch"},r.a.createElement(f.a,{item:!0,className:"".concat(t.mainGridBodyItem," ").concat(t.height11),style:{padding:"16px"}},i.length?r.a.createElement(f.a,{container:!0,className:"".concat(t.height12),direction:"column",justify:"center",alignItems:"stretch"},r.a.createElement(f.a,{item:!0,className:"".concat(t.height6)},r.a.createElement(f.a,{container:!0,className:"".concat(t.height12),direction:"row",justify:"center",alignItems:"stretch"},r.a.createElement(f.a,{item:!0,xs:10,style:{textAlign:"center",position:"relative"}},r.a.createElement(m.a,{variant:"h6",style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}},"number"==typeof v?"Ru"===s.currLang.current?i.find((function(e){return e.id===v})).name_rus:i.find((function(e){return e.id===v})).name_eng:s.currLang.texts.Nothink)),r.a.createElement(f.a,{item:!0,xs:2},r.a.createElement(N.a,{onClick:function(){u.push({pathname:"/addlocation",defaultData:{id:v,name_rus:i.find((function(e){return e.id===v})).name_rus,name_eng:i.find((function(e){return e.id===v})).name_eng,img_url:i.find((function(e){return e.id===v})).img_url,color:i.find((function(e){return e.id===v})).color,prevUrl:"/dreammap"}})},disabled:"number"!=typeof v},r.a.createElement(z.a,{fontSize:"small"}))))),r.a.createElement(f.a,{item:!0,className:"".concat(t.height6)},r.a.createElement(f.a,{container:!0,direction:"row",justify:"space-around",alignItems:"center"},r.a.createElement(f.a,{item:!0},r.a.createElement(w.a,null,r.a.createElement(C.a,{value:"number"==typeof v?v:"",onChange:function(e){k(e.target.value),W(e.target.value)},MenuProps:{PaperProps:{style:{maxHeight:224,width:"auto"}}}},i.map((function(e,a){return r.a.createElement(O.a,{key:a,value:e.id},r.a.createElement(I.a,{className:t.smallAvatar,src:e.id?e.img_url:"https://static.thenounproject.com/png/1446402-200.png",style:"dark"===l.type?{filter:"invert(1)"}:{}}))}))))),r.a.createElement(f.a,{item:!0},r.a.createElement(d.a,{disabled:0===_,onClick:function(){u.push({pathname:"/dreams",defaultData:{mode:"fromMap",location:i.find((function(e){return e.id===v})),prevUrl:"/dreammap"}})}},s.currLang.texts.CountDreams,": ",_))))):""),r.a.createElement(f.a,{item:!0,className:"".concat(t.mainGridBodyItem," ").concat(t.height1)},r.a.createElement(f.a,{className:t.menuDivButton,container:!0,direction:"row",justify:"space-around",alignItems:"stretch",style:{padding:"16px"}},r.a.createElement(f.a,{item:!0,xs:6,align:"center"},r.a.createElement(d.a,{className:t.poppupButton,variant:"contained",color:"secondary",onClick:function(){k(o),y(null)}},s.currLang.texts.cancel)),r.a.createElement(f.a,{item:!0,xs:6,align:"center"},r.a.createElement(d.a,{className:t.poppupButton,disabled:P,variant:"contained",color:"primary",onClick:function(){var e={user_id:p,i:a,j:n};e.oldLoc=o,e.newLoc=v,j.a.post("/actions/users/updateusermap",e).then((function(e){})).catch((function(e){console.log(e)})),y(null)}},s.currLang.buttons.Save)))))))}T.propTypes={lang:i.a.object.isRequired,palette:i.a.object.isRequired};var A=Object(c.b)((function(e){return{lang:e.lang,palette:e.themeMode.palette}}),(function(e){return{}}))(T);function M(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},c=Object.keys(e);for(n=0;n<c.length;n++)a=c[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(n=0;n<c.length;n++)a=c[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function P(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var a=[],n=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(n=(o=i.next()).done)&&(a.push(o.value),!t||a.length!==t);n=!0);}catch(e){r=!0,c=e}finally{try{n||null==i.return||i.return()}finally{if(r)throw c}}return a}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var W=(window.innerWidth-32)/20;function R(e){var t=e.lang,a=e.themeMode,n=e.history,c=e.user_id,o=Object(L.d)(),i=Object(k.a)(a),g=P(r.a.useState({}),2),E=g[0],b=g[1],w=P(r.a.useState(null),2),N=w[0],O=w[1],S=P(r.a.useState(null),2),C=S[0],I=S[1],_=P(r.a.useState(!0),2),z=_[0],B=_[1],T=r.a.useCallback((function(){B(!0),j.a.get("/gettags").then((function(e){b([{id:null}].concat(e.data))})).catch((function(e){console.log(e)})),j.a.post("/actions/users/getusermap",{user_id:c}).then((function(e){O(JSON.parse(e.data.result)),B(!1)})).catch((function(e){console.log(e),B(!1)}))}),[c]),R=r.a.useCallback((function(){j.a.post("/actions/users/getuserposts",{id:c}).then((function(e){I(e.data)}))}),[c]);return r.a.useEffect((function(){T(),R()}),[T,R]),r.a.createElement(x.a,{theme:i},r.a.createElement(u.a,null),r.a.createElement("div",{className:o.root},r.a.createElement(f.a,{container:!0,className:"".concat(o.height12),direction:"column",justify:"center",alignItems:"stretch"},r.a.createElement(f.a,{item:!0,className:"".concat(o.hiddenOverflow," ").concat(o.height2," ").concat(o.relativePosition),align:"center"},r.a.createElement(m.a,{variant:"h6",component:"div",className:"".concat(o.centerButton)},t.currLang.texts.DreamsMap)),r.a.createElement(f.a,{item:!0,className:"".concat(o.hiddenOverflow," ").concat(o.height9)},r.a.createElement("div",{style:{padding:16},className:"".concat(o.formControl," ").concat(o.fullMinWidthAbs)},z?r.a.createElement("div",{className:"".concat(o.formControl," ").concat(o.centerTextAlign)},r.a.createElement("div",{className:"".concat(o.inlineBlock," ").concat(o.relativePosition)},r.a.createElement(s.a,null)),r.a.createElement(m.a,{className:"".concat(o.relativePosition),component:"div"},t.currLang.texts.Loading)):r.a.createElement(l.TransformWrapper,{defaultScale:1.5,options:{minScale:.5,maxScale:2.5},zoomIn:{step:10},zoomOut:{step:10},doubleClick:{disabled:!0}},(function(e){var t,a,o,i=e.zoomIn,s=e.zoomOut,u=e.resetTransform;M(e,["zoomIn","zoomOut","resetTransform"]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(l.TransformComponent,null,r.a.createElement("table",{style:{borderCollapse:"collapse"}},r.a.createElement("tbody",null,null!==N?(t=[],a=0,o=0,Object.keys(N).forEach((function(e){var i=[];Object.keys(N[e]).forEach((function(t){i.push(r.a.createElement(A,{key:"cell"+a+o,i:a,j:o,cellWidth:W,dreamMap:N,id:N[e][t].id,locations:E,history:n,user_id:c,posts:C})),a++})),t.push(r.a.createElement("tr",{key:"row"+o},i)),o++,a=0})),t):r.a.createElement("tr",null,r.a.createElement("td",null))))),r.a.createElement(f.a,{container:!0,className:"tools",direction:"row",justify:"space-evenly",alignItems:"center",style:{marginTop:16}},r.a.createElement(f.a,{item:!0,xs:2,align:"center"}),r.a.createElement(f.a,{item:!0,xs:2,align:"center"},r.a.createElement(p.a,{size:"small",onClick:s},r.a.createElement(y.a,null))),r.a.createElement(f.a,{item:!0,xs:4,align:"center"},r.a.createElement(p.a,{size:"small",onClick:u},r.a.createElement(h.a,null))),r.a.createElement(f.a,{item:!0,xs:2,align:"center"},r.a.createElement(p.a,{size:"small",onClick:i},r.a.createElement(v.a,null))),r.a.createElement(f.a,{item:!0,xs:2,align:"center"})))})))),r.a.createElement(f.a,{item:!0,className:"".concat(o.mainGridBodyItem," ").concat(o.height1)},r.a.createElement(f.a,{container:!0,direction:"row",justify:"space-evenly",alignItems:"center"},r.a.createElement(f.a,{item:!0},r.a.createElement(d.a,{className:o.actionButton,variant:"contained",color:"secondary",onClick:function(){n.push("/luciddreams")}},t.currLang.buttons.close)),r.a.createElement(f.a,{item:!0},r.a.createElement(d.a,{className:o.actionButton,variant:"contained",color:"primary",onClick:function(){n.push("/addlocation")}},t.currLang.buttons.add)))))))}R.propTypes={themeMode:i.a.object.isRequired,lang:i.a.object.isRequired,user_id:i.a.number.isRequired};t.default=Object(c.b)((function(e){return{themeMode:e.themeMode,lang:e.lang,user_id:e.auth.user.id}}),(function(e){return{}}))(R)}}]);
//# sourceMappingURL=14.index-bundle.js.map