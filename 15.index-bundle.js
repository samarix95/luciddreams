(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{657:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(22),c=n(4),o=n.n(c),s=n(272),l=n(315),u=n(263),h=n(158),d=n(150),m=n(217),p=n(265),f=n(438),g=n(268),v=n(353),y=n(312),b=n(226),C=n(145),x=n(264),w=n(99),k=n(262),E=n(498),S=n.n(E);function W(e,t,n,a){for(var r=[],i=S()("rgb(".concat(e,", ").concat(t,", ").concat(n,")")).toHsl(),c=9;c>1;c-=8/a)i.l=.1*c,r.push(S()(i).toRgb());return r}function R(e){return S()(e).toRgb()}function O(e,t){return{inside:function(n){return n>=e&&n<=t}}}function B(e,t){return e-t/2}function N(e){return(N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function I(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],a=!0,r=!1,i=void 0;try{for(var c,o=e[Symbol.iterator]();!(a=(c=o.next()).done)&&(n.push(c.value),!t||n.length!==t);a=!0);}catch(e){r=!0,i=e}finally{try{a||null==o.return||o.return()}finally{if(r)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function j(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function P(e){return(P=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function M(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _(e,t){return(_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var D=2*Math.PI,A=D/4;function F(e){var t=e.toString(16);return 1==t.length?"0"+t:t}var L=function(e){function t(){var e,n,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(a=P(t).call(this))||"object"!==N(a)&&"function"!=typeof a?M(n):a).state={rgb:null,innerWheelOpen:!1,centerCircleOpen:!1},e.outerWheelBounds=null,e.innerWheelBounds=null,e.centerCircleBounds=null,e.outerWheelRadius=null,e.innerWheelRadius=null,e.centerCircleRadius=null,e.firstSpacerRadius=null,e.secondSpacerRadius=null,e.canvasEl=null,e.ctx=null,e.onCanvasHover=e.onCanvasHover.bind(M(e)),e.onCanvasClick=e.onCanvasClick.bind(M(e)),e}var n,a,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_(e,t)}(t,e),n=t,(a=[{key:"getRelativeMousePos",value:function(e,t){var n=this.props.radius,a=this.canvasEl.getBoundingClientRect(),r=2*n,i=2*n,c={x:e-a.left,y:t-a.top};return{fromCenter:Math.sqrt((c.x-i/2)*(c.x-i/2)+(c.y-r/2)*(c.y-r/2)),onCanvas:c}}},{key:"initCanvas",value:function(){var e=this.props.radius,t=2*e,n=2*e;this.ctx.clearRect(0,0,t,n),this.drawOuterWheel(),this.drawSpacers()}},{key:"componentWillMount",value:function(){var e=this.props,t=e.radius,n=e.lineWidth,a=e.padding;this.outerWheelRadius=t,this.innerWheelRadius=this.outerWheelRadius-n-a,this.centerCircleRadius=this.innerWheelRadius-n-a,this.firstSpacerRadius=this.outerWheelRadius-n,this.secondSpacerRadius=this.innerWheelRadius-n,this.outerWheelBounds=O(t-n,t),this.innerWheelBounds=O(this.innerWheelRadius-n,this.innerWheelRadius),this.centerCircleBounds=O(0,this.centerCircleRadius),this.firstSpacerBounds=O(this.firstSpacerRadius-a,this.firstSpacerRadius),this.secondSpacerBounds=O(this.secondSpacerRadius-a,this.secondSpacerRadius)}},{key:"componentDidMount",value:function(){var e=this;if(this.props.onRef(this),this.canvasEl=document.getElementById("colour-picker"),this.ctx=this.canvasEl.getContext("2d"),this.props.preset){var t=R(this.props.presetColour);this.setState({rgb:t},(function(){e.drawOuterWheel(),e.drawInnerWheel(),e.drawCenterCircle(),e.drawSpacers()}))}else this.drawOuterWheel(),this.drawSpacers()}},{key:"componentWillUnmount",value:function(){this.props.onRef(void 0)}},{key:"onCanvasHover",value:function(e){var t=e.clientX,n=e.clientY,a=this.getRelativeMousePos(t,n);this.outerWheelBounds.inside(a.fromCenter)?this.canvasEl.style.cursor="crosshair":this.innerWheelBounds.inside(a.fromCenter)&&this.state.innerWheelOpen?this.canvasEl.style.cursor="crosshair":this.centerCircleBounds.inside(a.fromCenter)&&this.state.centerCircleOpen?this.canvasEl.style.cursor="pointer":this.canvasEl.style.cursor="auto"}},{key:"onCanvasClick",value:function(e){var t=e.clientX,n=e.clientY,a=this.getRelativeMousePos(t,n);this.outerWheelBounds.inside(a.fromCenter)?this.outerWheelClicked(a.onCanvas):this.innerWheelBounds.inside(a.fromCenter)?this.innerWheelClicked(a.onCanvas):this.centerCircleBounds.inside(a.fromCenter)&&this.onCenterCircleClick()}},{key:"outerWheelClicked",value:function(e){var t=this,n=I(this.ctx.getImageData(e.x,e.y,1,1).data,3),a={r:n[0],g:n[1],b:n[2]};this.setState({rgb:a,innerWheelOpen:!0,centerCircleOpen:!0},(function(){t.drawInnerWheel(),t.drawCenterCircle()}))}},{key:"innerWheelClicked",value:function(e){var t=this,n=I(this.ctx.getImageData(e.x,e.y,1,1).data,3),a={r:n[0],g:n[1],b:n[2]};this.setState({rgb:a,centerCircleOpen:!0},(function(){t.drawCenterCircle()}))}},{key:"onCenterCircleClick",value:function(){var e=this.state.rgb;this.props.onCenterCircleClick("#"+F(e.r)+F(e.g)+F(e.b))}},{key:"setPresetColour",value:function(e){var t=this,n=R(function(e){var t;if(/^#([A-Fa-f0-9]{3}){1,2}$/.test(e))return 3==(t=e.substring(1).split("")).length&&(t=[t[0],t[0],t[1],t[1],t[2],t[2]]),"rgba("+[(t="0x"+t.join(""))>>16&255,t>>8&255,255&t].join(",")+",1)";throw new Error("Bad Hex")}(e));this.setState({rgb:n},(function(){t.drawOuterWheel(),t.drawInnerWheel(),t.drawCenterCircle(),t.drawSpacers()}))}},{key:"clear",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.setState({rgb:null,innerWheelOpen:!1,centerCircleOpen:!1},(function(){e.initCanvas(),t&&t()}))}},{key:"drawOuterWheel",value:function(){var e=this,t=this.props,n=t.radius,a=t.colours,r=t.lineWidth,i=2*n,c=2*n,o=B(n,r),s=a.map((function(e){return R(e)}));s.forEach((function(t,n){e.ctx.beginPath();var a=D/s.length*n,l=D/s.length*(n+1);e.ctx.arc(c/2,i/2,o,a,l),e.ctx.lineWidth=r,e.ctx.strokeStyle="rgb(".concat(t.r,", ").concat(t.g,", ").concat(t.b,")"),e.ctx.stroke(),e.ctx.closePath()}))}},{key:"drawSpacers",value:function(){this.props.spacers&&(this.drawSpacer(this.firstSpacerRadius),this.drawSpacer(this.secondSpacerRadius))}},{key:"drawSpacer",value:function(e){var t=this.props,n=t.radius,a=t.padding,r=t.spacers,i=r.colour,c=r.shadowColour,o=r.shadowBlur,s=2*n,l=2*n,u=B(e,a);this.ctx.beginPath(),this.ctx.arc(l/2,s/2,u,0,D),this.ctx.lineWidth=a,this.ctx.shadowColor=c,this.ctx.shadowBlur=o,this.ctx.strokeStyle=i,this.ctx.stroke(),this.ctx.closePath(),this.ctx.shadowColor="transparent"}},{key:"drawInnerWheel",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;window.requestAnimationFrame=t;var n=this.state.rgb,a=n.r,r=n.g,i=n.b,c=this.props,o=c.radius,s=c.lineWidth,l=c.shades,u=c.animated,h=2*o,d=2*o,m=B(this.innerWheelRadius,s);this.ctx.clearRect(0,0,d,h),this.drawOuterWheel(),this.drawSpacers();var p=W(a,r,i,l);function f(){var e=this;p.forEach((function(t,n){e.ctx.beginPath();var a=D/p.length*n+A,r=D/p.length*(n+1)+.5*Math.PI;e.ctx.arc(d/2,h/2,m,a,r),e.ctx.lineWidth=s,e.ctx.strokeStyle="rgb(".concat(t.r,", ").concat(t.g,", ").concat(t.b,")"),e.ctx.stroke(),e.ctx.closePath()}))}function g(){var n=this;p.forEach((function(t,a){n.ctx.beginPath();var r=D/p.length*a+A,i=D/p.length*(a+1)+.5*Math.PI;n.ctx.arc(d/2,h/2,m,r,i),n.ctx.lineWidth=s*e,n.ctx.strokeStyle="rgb(".concat(t.r,", ").concat(t.g,", ").concat(t.b,")"),n.ctx.stroke(),n.ctx.closePath()})),(e+=.1)<1&&t(g)}g=g.bind(this),f=f.bind(this),u?g():f()}},{key:"drawCenterCircle",value:function(){var e=this.state.rgb,t=this.props.radius,n=2*t,a=2*t;this.ctx.lineWidth=0,this.ctx.beginPath(),this.ctx.arc(a/2,n/2,this.centerCircleRadius,0,2*Math.PI),this.ctx.fillStyle="rgb(".concat(e.r,", ").concat(e.g,", ").concat(e.b,")"),this.ctx.fill(),this.ctx.lineWidth=.1,this.ctx.strokeStyle="rgb(".concat(e.r,", ").concat(e.g,", ").concat(e.b,")"),this.ctx.stroke(),this.ctx.closePath(),this.ctx.beginPath(),this.ctx.moveTo(t-t/10,t),this.ctx.lineTo(t-t/10,t),this.ctx.lineTo(t,t+t/12),this.ctx.lineTo(t+t/10,t-t/12),this.ctx.strokeStyle="black",this.ctx.lineWidth=5,this.ctx.stroke()}},{key:"render",value:function(){var e=this.props,t=e.radius;return e.dynamicCursor?r.a.createElement("canvas",{id:"colour-picker",onClick:this.onCanvasClick,onMouseMove:this.onCanvasHover,width:"".concat(2*t,"px"),height:"".concat(2*t,"px")}):r.a.createElement("canvas",{id:"colour-picker",onClick:this.onCanvasClick,width:"".concat(2*t,"px"),height:"".concat(2*t,"px")})}}])&&j(n.prototype,a),i&&j(n,i),t}(a.Component);L.propTypes={radius:o.a.number.isRequired,lineWidth:o.a.number.isRequired,colours:o.a.array,shades:o.a.number,padding:o.a.number,dynamicCursor:o.a.bool,spacers:o.a.object,preset:o.a.bool,componentToHex:o.a.func,setPresetColour:o.a.func,onCenterCircleClick:o.a.func},L.defaultProps={colours:["#00C3A9","#00B720","#008813","#000000","#FFFFFF","#F8E300","#FF6400","#E20000","#AC000D","#9E005F","#6D0E82","#3B3887","#175FDA","#0091E2","#00BCED","#14E4C5"],shades:16,padding:0,dynamicCursor:!0,preset:!1,animate:!1};var q=L,T=n(7),H=n(2),G=n(40),U=n(39);function J(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],a=!0,r=!1,i=void 0;try{for(var c,o=e[Symbol.iterator]();!(a=(c=o.next()).done)&&(n.push(c.value),!t||n.length!==t);a=!0);}catch(e){r=!0,i=e}finally{try{a||null==o.return||o.return()}finally{if(r)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var X=(window.innerWidth-100)/2>200?200:(window.innerWidth-100)/2;function Y(e){var t=e.lang,n=e.themeMode,a=e.history,i=e.palette,c=e.setSnackbar,o=Object(U.b)(),E=Object(w.a)(n),S=J(r.a.useState(!1),2),W=S[0],R=S[1],O=J(r.a.useState(""),2),B=O[0],N=O[1],I=J(r.a.useState(!1),2),j=I[0],P=I[1],M=J(r.a.useState([]),2),_=M[0],D=M[1],A=J(r.a.useState(""),2),F=A[0],L=A[1],T=J(r.a.useState(""),2),Y=T[0],z=T[1],$=J(r.a.useState(""),2),K=$[0],Q=$[1],V=J(r.a.useState(""),2),Z=V[0],ee=V[1],te=J(r.a.useState("#ffffff"),2),ne=te[0],ae=te[1],re=J(r.a.useState(!1),2),ie=re[0],ce=re[1];return r.a.useEffect((function(){if(void 0!==e.location.defaultData){if("number"==typeof e.location.defaultData.id){R(!0);var t=e.location.defaultData,n=t.name_rus,a=t.name_eng,r=t.img_url,i=t.color,c=t.prevUrl;Q(n),z(a),ee(r),ae(i),N(c),P(!0),function e(t,n){G.l.post("/actions/users/geticons",t).then((function(a){if(0===a.data.length)e(t,n);else{var r=[];r.push(n);var i=r.concat(a.data);D(i),P(!1)}}))}({name:a},r)}else{var o=e.location.defaultData.prevUrl;N(o)}}}),[e.location.defaultData]),r.a.createElement(k.a,{theme:E},r.a.createElement(u.a,null),r.a.createElement(y.a,{onClose:function(){ce(!1)},open:ie},r.a.createElement(l.a,{style:{padding:"8px"}},r.a.createElement(q,{radius:X,padding:10,lineWidth:30,onCenterCircleClick:function(e){return ae(e),void ce(!1)},onRef:function(e){return q.ColourWheel=e},spacers:{colour:"#00000000",shadowColour:"grey",shadowBlur:5},preset:!0,presetColour:ne,animated:!0}))),r.a.createElement("div",{className:o.root},r.a.createElement(x.a,{container:!0,className:"".concat(o.height12),direction:"column",justify:"center",alignItems:"stretch"},r.a.createElement(x.a,{item:!0,className:"".concat(o.mainGridBodyItem," ").concat(o.height11)},r.a.createElement(C.a,{className:o.paper},r.a.createElement(x.a,{className:"".concat(o.height12),container:!0,direction:"column",justify:"center",alignItems:"stretch"},r.a.createElement(x.a,{item:!0,className:"".concat(o.mainGridBodyItem," ").concat(o.height5)},r.a.createElement(x.a,{container:!0,className:"".concat(o.height6),direction:"column",justify:"center",alignItems:"center"},r.a.createElement(x.a,{item:!0,className:o.fullMinWidth},r.a.createElement(p.a,{className:o.inputDiv,disabled:!!j,required:!0,id:"input-ru",value:K,label:t.currLang.texts.Name+" Ru",variant:"outlined",onChange:function(e){Q(e.target.value)}}))),r.a.createElement(x.a,{container:!0,className:"".concat(o.height6),direction:"column",justify:"center",alignItems:"center"},r.a.createElement(x.a,{item:!0,className:o.fullMinWidth},r.a.createElement(p.a,{className:o.inputDiv,disabled:!!j,required:!0,id:"input-en",value:Y,label:t.currLang.texts.Name+" En",variant:"outlined",onChange:function(e){var t=e.target.value,n=/[а-яА-ЯёЁ]/g;-1!==t.search(n)&&(t=t.replace(n,"")),z(t)}})))),r.a.createElement(x.a,{item:!0,className:"".concat(o.mainGridBodyItem," ").concat(o.height3)},r.a.createElement(x.a,{className:"".concat(o.height12),container:!0,direction:"column",justify:"center",alignItems:"stretch"},r.a.createElement(x.a,{item:!0,className:"".concat(o.mainGridBodyItem," ").concat(o.height6)},r.a.createElement(p.a,{className:o.inputDiv,disabled:!!j,value:F,id:"input-search",label:t.currLang.texts.FindIcon,variant:"outlined",onChange:function(e){var t=e.target.value,n=/[а-яА-ЯёЁ]/g;-1!==t.search(n)&&(t=t.replace(n,"")),L(t)},onBlur:function e(){if(0!==F.length){P(!0);var t={name:F.replace(/ /g,"%20")};G.l.post("/actions/users/geticons",t).then((function(t){0===t.data.length?e():(D(t.data),P(!1))}))}}})),r.a.createElement(x.a,{item:!0,className:"".concat(o.mainGridBodyItem," ").concat(o.height6)},r.a.createElement("div",{className:o.formControl},j?r.a.createElement(s.a,null):r.a.createElement(h.a,{disabled:0===_.length},r.a.createElement(m.a,{id:"select-icon"},t.currLang.texts.ChangeIcon),r.a.createElement(b.a,{value:Z,style:{minWidth:100},labelId:"select-icon",onChange:function(e){ee(e.target.value)},MenuProps:{PaperProps:{style:{maxHeight:224,width:"auto"}}}},_.map((function(e,t){return r.a.createElement(f.a,{key:t,value:e},r.a.createElement(v.a,{className:o.smallAvatar,src:e,style:"dark"===i.type?{filter:"invert(1)"}:{}}))})))))))),r.a.createElement(x.a,{item:!0,className:"".concat(o.mainGridBodyItem," ").concat(o.height4)},r.a.createElement(d.a,{className:"".concat(o.width4," ").concat(o.height4," ").concat(o.centerButton),focusRipple:!0,onClick:function(){ce(!0)},style:{backgroundColor:ne,borderRadius:8}}))))),r.a.createElement(x.a,{item:!0,className:"".concat(o.mainGridBodyItem," ").concat(o.height1)},r.a.createElement(x.a,{container:!0,direction:"row",justify:"space-evenly",alignItems:"center"},r.a.createElement(x.a,{item:!0},r.a.createElement(g.a,{className:o.actionButton,variant:"contained",color:"secondary",onClick:function(){0===B.length?a.push("/dreammap"):a.push(B)}},t.currLang.buttons.Back)),r.a.createElement(x.a,{item:!0},r.a.createElement(g.a,{variant:"contained",color:"primary",className:o.actionButton,onClick:function(){return function(){var n="",r=!1;if(W){var i=!1,o={id:e.location.defaultData.id};K!==e.location.defaultData.name_rus&&(o.name_rus=K,i=!0),Y!==e.location.defaultData.name_eng&&(o.name_eng=Y,i=!0),Z!==e.location.defaultData.img_url&&(o.img_url=Z,i=!0),ne!==e.location.defaultData.color&&(o.color=ne,i=!0),i?G.l.post("/actions/users/updatelocation",o).then((function(e){c({type:H.O,snackbar:{open:!0,variant:"success",message:t.currLang.texts.success}}),0===B.length?a.push("/dreammap"):a.push(B)})).catch((function(e){c({type:H.O,snackbar:{open:!0,variant:"error",message:t.currLang.errors.CantUpdateLocation}})})):c({type:H.O,snackbar:{open:!0,variant:"error",message:t.currLang.errors.NO_CHANGES}})}else if(0===ne.length&&(n=t.currLang.errors.ColorNotChange,r=!0),0===Z.length&&(n=t.currLang.errors.IconNotChange,r=!0),0===K.length&&(n=t.currLang.errors.EmptyName,r=!0),0===Y.length&&(n=t.currLang.errors.EmptyName,r=!0),r)c({type:H.O,snackbar:{open:!0,variant:"error",message:n}});else{var s={name_rus:K,name_eng:Y,img_url:Z,color:ne};G.l.post("/actions/users/createlocation",s).then((function(e){c({type:H.O,snackbar:{open:!0,variant:"success",message:t.currLang.texts.success}}),0===B.length?a.push("/dreammap"):a.push(B)})).catch((function(e){c({type:H.O,snackbar:{open:!0,variant:"error",message:t.currLang.errors.CantAddLocation}})}))}}()}},W?t.currLang.buttons.Save:t.currLang.buttons.add)))))))}Y.propTypes={setSnackbar:o.a.func.isRequired,themeMode:o.a.object.isRequired,lang:o.a.object.isRequired,palette:o.a.object.isRequired};t.default=Object(i.b)((function(e){return{themeMode:e.themeMode,palette:e.themeMode.palette,lang:e.lang}}),(function(e){return{setSnackbar:function(t){return e(Object(T.M)(t))}}}))(Y)}}]);
//# sourceMappingURL=15.index-bundle.js.map