(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{884:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(23),o=a(30),i=a(3),l=a.n(i),u=a(850),s=a(256),m=a(247),d=a(254),f=a(252),p=a(248),g=a(726),h=a(852),E=a.n(h),b=a(851),y=a.n(b),v=a(853),j=a.n(v),k=a(70),O=a(85),w=a(91),x=a(246),N=a(144),C=a(255),S=a(502),_=a(203),I=a(210),D=a(418),z=a(320),M=a.n(z),T=a(12);function B(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var a=[],n=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(n=(o=i.next()).done)&&(a.push(o.value),!t||a.length!==t);n=!0);}catch(e){r=!0,c=e}finally{try{n||null==i.return||i.return()}finally{if(r)throw c}}return a}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function L(e){var t=Object(T.d)(),a=e.i,n=e.j,c=e.cellWidth,o=e.id,i=e.locations,l=e.palette,u=e.lang,s=e.history,m=e.user_id,g=e.posts,h=e.viewMode,E=B(r.a.useState(null),2),b=E[0],y=E[1],v=B(r.a.useState(o||null),2),j=v[0],O=v[1],w=B(r.a.useState(0),2),x=w[0],z=w[1],L=Boolean(b),A=L?"simple-popover":void 0,P=j===o,R=function(e){var t=0;h||g.map((function(a){return a.tags.map((function(a){return parseInt(a[0])===e?t++:t+=0}))})),z(t)};return r.a.createElement("td",{style:{height:c+"px",minWidth:c+"px",maxWidth:c+"px",padding:0,margin:0,border:"1px rgb(128,128,128,0.8) solid"}},i.length?r.a.createElement("div",{className:t.aboutGridContainer,onClick:function(e){y(e.currentTarget),R(j)},style:"number"==typeof j?{backgroundImage:"url("+i.find((function(e){return e.id===j})).img_url+")",backgroundSize:"contain",backgroundColor:i.find((function(e){return e.id===j})).color,overflow:"hidden"}:{backgroundSize:"contain",backgroundColor:"rgb(192,192,192,0.6)",overflow:"hidden"}}):"",r.a.createElement(_.a,{id:A,open:L,anchorEl:b,anchorOrigin:{vertical:"center",horizontal:"center"},transformOrigin:{vertical:"center",horizontal:"center"}},r.a.createElement(p.a,{container:!0,className:"".concat(t.height12," ").concat(t.minWidth200px),direction:"column",justify:"center",alignItems:"stretch"},r.a.createElement(p.a,{item:!0,className:"".concat(t.mainGridBodyItem," ").concat(t.height11),style:{padding:"16px"}},i.length?r.a.createElement(p.a,{container:!0,className:"".concat(t.height12),direction:"column",justify:"center",alignItems:"stretch"},r.a.createElement(p.a,{item:!0,className:"".concat(t.height6," ").concat(t.minHeight20px)},r.a.createElement(p.a,{container:!0,className:"".concat(t.height12),direction:"row",justify:"center",alignItems:"stretch"},r.a.createElement(p.a,{item:!0,xs:10,style:{textAlign:"center",position:"relative"}},r.a.createElement(d.a,{className:"".concat(t.centerButton)},"number"==typeof j?"Ru"===u.currLang.current?i.find((function(e){return e.id===j})).name_rus:i.find((function(e){return e.id===j})).name_eng:u.currLang.texts.Nothink)),h?r.a.createElement(r.a.Fragment,null):r.a.createElement(p.a,{item:!0,xs:2},r.a.createElement(C.a,{onClick:function(){s.push({pathname:"/addlocation",defaultData:{id:j,name_rus:i.find((function(e){return e.id===j})).name_rus,name_eng:i.find((function(e){return e.id===j})).name_eng,img_url:i.find((function(e){return e.id===j})).img_url,color:i.find((function(e){return e.id===j})).color,prevUrl:"/dreammap"}})},disabled:"number"!=typeof j},r.a.createElement(M.a,{fontSize:"small"}))))),r.a.createElement(p.a,{item:!0,className:"".concat(t.height6)},r.a.createElement(p.a,{container:!0,direction:"row",justify:"space-around",alignItems:"center"},r.a.createElement(p.a,{item:!0},r.a.createElement(N.a,null,r.a.createElement(I.a,{disabled:h,value:"number"==typeof j?j:"",onChange:function(e){O(e.target.value),R(e.target.value)},MenuProps:{PaperProps:{style:{maxHeight:224,width:"auto"}}}},i.map((function(e,a){return r.a.createElement(S.a,{key:a,value:e.id},r.a.createElement(D.a,{className:t.smallAvatar,src:e.id?e.img_url:"https://static.thenounproject.com/png/1446402-200.png",style:"dark"===l.type?{filter:"invert(1)"}:{}}))}))))),h?r.a.createElement(r.a.Fragment,null):r.a.createElement(p.a,{item:!0},r.a.createElement(f.a,{disabled:0===x,onClick:function(){s.push({pathname:"/dreams",defaultData:{mode:"fromMap",location:i.find((function(e){return e.id===j})),prevUrl:"/dreammap"}})}},u.currLang.texts.CountDreams,": ",x))))):""),r.a.createElement(p.a,{item:!0,className:"".concat(t.mainGridBodyItem," ").concat(t.height1)},r.a.createElement(p.a,{container:!0,direction:"row",justify:"space-around",alignItems:"stretch",style:{padding:"16px"}},r.a.createElement(p.a,{item:!0},r.a.createElement(f.a,{className:t.poppupButton,variant:"contained",color:"secondary",onClick:function(){O(o),y(null)}},u.currLang.buttons.close)),h?r.a.createElement(r.a.Fragment,null):r.a.createElement(p.a,{item:!0},r.a.createElement(f.a,{className:t.poppupButton,disabled:P,variant:"contained",color:"primary",onClick:function(){var e={user_id:m,i:a,j:n};e.oldLoc=o,e.newLoc=j,k.c.post("/actions/users/updateusermap",e).then((function(e){})).catch((function(e){console.log(e)})),y(null)}},u.currLang.buttons.Save)))))))}L.propTypes={lang:l.a.object.isRequired,palette:l.a.object.isRequired};var A=Object(c.b)((function(e){return{lang:e.lang,palette:e.themeMode.palette}}),(function(e){return{}}))(L);function P(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},c=Object.keys(e);for(n=0;n<c.length;n++)a=c[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(n=0;n<c.length;n++)a=c[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function R(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var a=[],n=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(n=(o=i.next()).done)&&(a.push(o.value),!t||a.length!==t);n=!0);}catch(e){r=!0,c=e}finally{try{n||null==i.return||i.return()}finally{if(r)throw c}}return a}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var q=(window.innerWidth-32)/20;function W(e){var t=e.lang,a=e.themeMode,n=e.history,c=e.user_id,o=e.tags,i=e.tagsError,l=(e.tagsPending,e.fetchTags);i&&(console.log("DreamMap"),console.log(i));var h=Object(T.d)(),b=Object(w.a)(a),v=R(r.a.useState(null),2),O=v[0],N=v[1],C=R(r.a.useState(null),2),S=C[0],_=C[1],I=R(r.a.useState(!0),2),D=I[0],z=I[1],M=R(r.a.useState(!1),2),B=M[0],L=M[1],W=r.a.useCallback((function(e){z(!0),l(),k.c.post("/actions/users/getusermap",{user_id:e}).then((function(e){N(JSON.parse(e.data.result)),z(!1)})).catch((function(e){console.log(e),z(!1)}))}),[c]),F=r.a.useCallback((function(){k.c.post("/actions/users/getuserposts",{id:c}).then((function(e){_(e.data)}))}),[c]);return r.a.useEffect((function(){void 0!==e.location.defaultData?"fromFriend"===e.location.defaultData.mode&&(L(!0),W(e.location.defaultData.friend_id)):(W(c),F())}),[W,F]),r.a.createElement(x.a,{theme:b},r.a.createElement(m.a,null),r.a.createElement("div",{className:h.root},r.a.createElement(p.a,{container:!0,className:"".concat(h.height12),direction:"column",justify:"center",alignItems:"stretch"},r.a.createElement(p.a,{item:!0,className:"".concat(h.hiddenOverflow," ").concat(h.height2," ").concat(h.relativePosition),align:"center"},r.a.createElement(d.a,{variant:"h6",component:"div",className:"".concat(h.centerButton)},t.currLang.texts.DreamsMap," ",void 0!==e.location.defaultData?" "+e.location.defaultData.nickName:"")),r.a.createElement(p.a,{item:!0,className:"".concat(h.hiddenOverflow," ").concat(h.height9)},r.a.createElement("div",{style:{padding:16},className:"".concat(h.formControl," ").concat(h.fullMinWidthAbs)},D?r.a.createElement("div",{className:"".concat(h.formControl," ").concat(h.centerTextAlign)},r.a.createElement("div",{className:"".concat(h.inlineBlock," ").concat(h.relativePosition)},r.a.createElement(s.a,null)),r.a.createElement(d.a,{className:"".concat(h.relativePosition),component:"div"},t.currLang.texts.Loading)):r.a.createElement(u.TransformWrapper,{defaultScale:1.5,options:{minScale:.5,maxScale:2.5},zoomIn:{step:10},zoomOut:{step:10},doubleClick:{disabled:!0}},(function(e){var t,a,i,l=e.zoomIn,s=e.zoomOut,m=e.resetTransform;P(e,["zoomIn","zoomOut","resetTransform"]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(u.TransformComponent,null,r.a.createElement("table",{style:{borderCollapse:"collapse"}},r.a.createElement("tbody",null,null!==O?(t=[],a=0,i=0,Object.keys(O).forEach((function(e){var l=[];Object.keys(O[e]).forEach((function(t){l.push(r.a.createElement(A,{key:"cell"+a+i,i:a,j:i,cellWidth:q,dreamMap:O,id:O[e][t].id,locations:o,history:n,user_id:c,posts:S,viewMode:B})),a++})),t.push(r.a.createElement("tr",{key:"row"+i},l)),i++,a=0})),t):r.a.createElement("tr",null,r.a.createElement("td",null))))),r.a.createElement(p.a,{container:!0,className:"tools",direction:"row",justify:"space-evenly",alignItems:"center",style:{marginTop:16}},r.a.createElement(p.a,{item:!0,xs:2,align:"center"}),r.a.createElement(p.a,{item:!0,xs:2,align:"center"},r.a.createElement(g.a,{size:"small",onClick:s},r.a.createElement(y.a,null))),r.a.createElement(p.a,{item:!0,xs:4,align:"center"},r.a.createElement(g.a,{size:"small",onClick:m},r.a.createElement(E.a,null))),r.a.createElement(p.a,{item:!0,xs:2,align:"center"},r.a.createElement(g.a,{size:"small",onClick:l},r.a.createElement(j.a,null))),r.a.createElement(p.a,{item:!0,xs:2,align:"center"})))})))),r.a.createElement(p.a,{item:!0,className:"".concat(h.mainGridBodyItem," ").concat(h.height1)},r.a.createElement(p.a,{container:!0,direction:"row",justify:"space-evenly",alignItems:"center"},r.a.createElement(p.a,{item:!0},r.a.createElement(f.a,{className:h.actionButton,variant:"contained",color:"secondary",onClick:function(){void 0!==e.location.defaultData?"fromFriend"===e.location.defaultData.mode?n.push({pathname:e.location.defaultData.prevUrl,defaultData:{friend_id:e.location.defaultData.friend_id,prevUrl:"/dreammap"}}):n.push(e.location.defaultData.prevUrl):n.push("/luciddreams")}},t.currLang.buttons.Back)),B?r.a.createElement(r.a.Fragment,null):r.a.createElement(p.a,{item:!0},r.a.createElement(f.a,{className:h.actionButton,variant:"contained",color:"primary",onClick:function(){n.push("/addlocation")}},t.currLang.buttons.add)))))))}W.propTypes={themeMode:l.a.object.isRequired,lang:l.a.object.isRequired,user_id:l.a.number.isRequired,tagsError:l.a.object.isRequired,tags:l.a.object.isRequired,tagsPending:l.a.object.isRequired};t.default=Object(c.b)((function(e){return{themeMode:e.themeMode,lang:e.lang,user_id:e.auth.user.id,tagsError:Object(O.b)(e),tags:[{id:null}].concat(Object(O.a)(e)),tagsPending:Object(O.c)(e)}}),(function(e){return Object(o.bindActionCreators)({fetchTags:k.a},e)}))(W)}}]);
//# sourceMappingURL=16.index-bundle.js.map